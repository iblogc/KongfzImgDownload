// ==UserScript==
// @name         å­”å¤«å­æ—§ä¹¦ç½‘å›¾ç‰‡ä¸‹è½½ï¼ˆè‡ªåŠ¨å»æ°´å°ï¼‰-è·¯äººç”²ä¹™ä¸™
// @description  ä½•ä»¥ç”Ÿè´¢ï¼Œå”¯æœ‰å®æˆ˜ã€‚ï¼ˆé—®é¢˜åé¦ˆè”ç³»å¾®ä¿¡Byte4Meï¼‰
// @version      4.0
// @author       è·¯äººç”²ä¹™ä¸™
// @namespace    iblogc
// @match        *://search.kongfz.com/*
// @match        *://book.kongfz.com/*
// @match        *://item.kongfz.com/*
// @match        *://book.kongfz.com/C*
// @require      https://cdn.jsdelivr.net/npm/regenerator-runtime@0.14.1/runtime.min.js
// @grant        GM_addStyle
// @grant        GM_download
// @grant        GM_xmlhttpRequest
// @license      Apache License, Version 2.0
// @homepage     https://greasyfork.org/zh-CN/scripts/467062-%E5%AD%94%E5%A4%AB%E5%AD%90%E6%97%A7%E4%B9%A6%E7%BD%91%E5%9B%BE%E7%89%87%E4%B8%8B%E8%BD%BD-%E8%87%AA%E5%8A%A8%E5%8E%BB%E6%B0%B4%E5%8D%B0-%E8%B7%AF%E4%BA%BA%E7%94%B2%E4%B9%99%E4%B8%99
// @downloadURL https://update.greasyfork.org/scripts/467062/%E5%AD%94%E5%A4%AB%E5%AD%90%E6%97%A7%E4%B9%A6%E7%BD%91%E5%9B%BE%E7%89%87%E4%B8%8B%E8%BD%BD%EF%BC%88%E8%87%AA%E5%8A%A8%E5%8E%BB%E6%B0%B4%E5%8D%B0%EF%BC%89-%E8%B7%AF%E4%BA%BA%E7%94%B2%E4%B9%99%E4%B8%99.user.js
// @updateURL https://update.greasyfork.org/scripts/467062/%E5%AD%94%E5%A4%AB%E5%AD%90%E6%97%A7%E4%B9%A6%E7%BD%91%E5%9B%BE%E7%89%87%E4%B8%8B%E8%BD%BD%EF%BC%88%E8%87%AA%E5%8A%A8%E5%8E%BB%E6%B0%B4%E5%8D%B0%EF%BC%89-%E8%B7%AF%E4%BA%BA%E7%94%B2%E4%B9%99%E4%B8%99.meta.js
// ==/UserScript==

"use strict";function _asyncToGenerator(n){return function(){var e=n.apply(this,arguments);return new Promise(function(n,t){function o(r,a){try{var i=e[r](a),l=i.value}catch(n){return void t(n)}if(!i.done)return Promise.resolve(l).then(function(n){o("next",n)},function(n){o("throw",n)});n(l)}return o("next")})}}!function(){function n(n){B=n,localStorage.setItem(w,n)}function e(){C=!0,localStorage.setItem(k,"true")}function t(n){return n.replace(/(_water|_n|_p|_b|_s)/g,"")}function o(n,e){var t=n.createElement("button");t.innerText="ğŸ‘‰ ä¸‹è½½å›¾ç‰‡",t.className="searchPageDownloadButton item-button",t.style.backgroundColor="#8c222c",t.style.color="white";var o=e.querySelector("div.add-cart-btn")||e.querySelector("div.add-cart-button");return o.parentNode.insertBefore(t,o.nextSibling),t}function r(n,e){var t=n.createElement("button");t.innerText="ğŸ‘‰ ä¸‹è½½å›¾ç‰‡",t.className="searchPageDownloadButton item-button",t.style.backgroundColor="#8c222c",t.style.color="white";var o=e.querySelector("div.add-cart-btn")||e.querySelector("div.add-cart-button");return o.parentNode.insertBefore(t,o.nextSibling),t}function a(n,e){var t=n.createElement("button");t.innerText="ğŸ‘‰ ä¸‹è½½å›¾ç‰‡",t.className="bookListPageDownloadButton",t.style.backgroundColor="#8c222c",t.style.color="white";var o=e.querySelector("a.con-btn-cart");return o.parentNode.insertBefore(t,o.nextSibling),t}function i(n,e){d(n,e)}function l(n){var e=n.querySelectorAll("ul#figure-info-box > li");return Array.from(e,function(n){return n.querySelector("img").getAttribute("_viewsrc")})}function c(n){return console.log("å¼€å§‹Canvaså¤„ç†æ°´å°ï¼ŒåŸå›¾URL:",n),new Promise(function(e,t){var o=new Image;o.crossOrigin="anonymous",o.onload=function(){console.log("å›¾ç‰‡åŠ è½½æˆåŠŸï¼Œå°ºå¯¸:",o.width,"x",o.height);var n=document.createElement("canvas"),r=n.getContext("2d");n.width=o.width,n.height=o.height,r.drawImage(o,0,0);var a=o.width-200,i=o.height-80;console.log("å¤„ç†æ°´å°åŒºåŸŸ:",{x:a,y:i,width:200,height:80});for(var l=0,c=0,d=0,s=0,u=a+200-5;u<a+200;u++)for(var p=i+80-5;p<i+80;p++){var f=r.getImageData(u,p,1,1).data;l+=f[0],c+=f[1],d+=f[2],s++}for(var g=Math.round(l/s),m=Math.round(c/s),h=Math.round(d/s),x=r.getImageData(a,i,200,80),b=x.data,v=0;v<b.length;v+=4)b[v]=g+10*(Math.random()-.5),b[v+1]=m+10*(Math.random()-.5),b[v+2]=h+10*(Math.random()-.5),b[v+3]=245;r.putImageData(x,a,i),r.filter="blur(2px)",r.fillStyle="rgba("+g+", "+m+", "+h+", 0.3)",r.fillRect(a,i,200,80),r.filter="none",n.toBlob(function(n){if(n){var o=URL.createObjectURL(n);console.log("Canvaså¤„ç†å®Œæˆï¼Œç”Ÿæˆæ–°URL:",o),e(o)}else console.error("Canvasè½¬Blobå¤±è´¥"),t(new Error("Canvas to Blob conversion failed"))},"image/jpeg",.95)},o.onerror=function(n){console.error("å›¾ç‰‡åŠ è½½å¤±è´¥:",n),t(new Error("Image loading failed"))},o.src=n})}function d(e,o){function r(){o.style.lineHeight="20px",o.innerText="ğŸ“¢æ€»è®¡ï¼š"+a.length+"\nâœ¨å»æ°´å°ä¸€ï¼š"+d+"\nğŸ¨å»æ°´å°äºŒï¼š"+u+"\nğŸ”„æœªå»æ°´å°ï¼š"+p+"\nğŸ˜­ä¸‹è½½å¤±è´¥ï¼š"+f+"\n",o.appendChild(i),f>0?(o.style.backgroundColor="#c97c75",o.style.color="#fff"):(o.style.backgroundColor="#7b7475",o.style.color="#fff")}var a=l(e);o.style.cursor="not-allowed";var i=document.createElement("a");if(i.href="https://greasyfork.s3.us-east-2.amazonaws.com/lp9hdyffstt0wpz2ub39gw9p6srr",i.target="_blank",i.textContent="ğŸ›é—®é¢˜åé¦ˆ",i.style.color="#ffeb83",0===a.length)return o.innerText="ğŸ§å•†å“è¯¦æƒ…ä¸­æ²¡\næœ‰å›¾ç‰‡å¯ä»¥ä¸‹è½½\n",o.style.backgroundColor="#ccc",o.style.color="#999",i.style.color="#b55222",void o.appendChild(i);o.disabled=!0,o.innerText="Downloading...";var d=0,u=0,p=0,f=0,g=(e.querySelector('meta[name="keywords"]').getAttribute("content")||"").match(/([^,]+)/),m=g&&g.length>1?g[1]:"",h=(e.querySelector('meta[name="description"]').getAttribute("content")||"").match(/ISBNï¼š([0-9]*)/),x=h&&h.length>1?h[1]:"";a.forEach(function(e,i){function l(t){var g=this,b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=arguments.length>2&&void 0!==arguments[2]&&arguments[2],y=void 0;y=v?"æœªå»æ°´å°":b?"å»æ°´å°äºŒ":"å»æ°´å°ä¸€";var w=y+"_"+m.trim()+"-"+x.trim()+"-"+(i+1)+"."+(h||"jpg");console.log("å¼€å§‹ä¸‹è½½å›¾ç‰‡:",{url:t,filename:w,isRetry:b,isOriginal:v,currentProgress:d+u+p+f+1+"/"+a.length}),GM_download({url:t,name:w,onprogress:function(n){o.innerText="Downloading...("+(i+1)+"/"+a.length+")"},onload:function(){v?(p++,console.log("åŸå›¾ä¸‹è½½æˆåŠŸ - æ€»è¿›åº¦: "+(d+u+p+f)+"/"+a.length)):b?(u++,console.log("Canvaså¤„ç†å›¾ç‰‡ä¸‹è½½æˆåŠŸ - æ€»è¿›åº¦: "+(d+u+p+f)+"/"+a.length)):(d++,console.log("ç›´æ¥å»æ°´å°ä¸‹è½½æˆåŠŸ - æ€»è¿›åº¦: "+(d+u+p+f)+"/"+a.length)),d+u+p+f===a.length&&(console.log("æ‰€æœ‰å›¾ç‰‡å¤„ç†å®Œæˆ:",{"ç›´æ¥å»æ°´å°æˆåŠŸ":d,"Canvaså¤„ç†æˆåŠŸ":u,"åŸå›¾ä¸‹è½½":p,"å¤±è´¥":f}),r(),n(B+d+u+p),(B%100==0&&0!==B&&!C||B>1e3&&!C)&&s())},onerror:function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function n(t){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(b||v){n.next=15;break}return console.log("æ— æ°´å°é“¾æ¥ä¸‹è½½å¤±è´¥ï¼Œå°è¯•Canvaså¤„ç†...",t),n.prev=2,n.next=5,c(e);case 5:o=n.sent,l(o,!0,!1),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(2),console.log("Canvaså¤„ç†å¤±è´¥ï¼Œé™çº§åˆ°åŸå›¾ä¸‹è½½:",n.t0),l(e,!0,!0);case 13:n.next=16;break;case 15:b&&!v?(console.log("Canvaså¤„ç†å›¾ç‰‡ä¸‹è½½å¤±è´¥ï¼Œé™çº§åˆ°åŸå›¾ä¸‹è½½:",t),l(e,!0,!0)):(f++,console.error("å›¾ç‰‡ä¸‹è½½å®Œå…¨å¤±è´¥:",t),d+u+p+f===a.length&&r());case 16:case"end":return n.stop()}},n,g,[[2,9]])}));return function(e){return n.apply(this,arguments)}}()})}var g=t(e),h=(g.split(".").pop()||"").toLowerCase();m.trim(),x.trim();l(g)})}function s(){v();var n=document.createElement("div");n.classList.add("overlay"),document.body.appendChild(n);var t=document.createElement("div");t.classList.add("donation-popup"),t.innerHTML='\n              <div class="donation-header">\n                  <p>å­”å¤«å­æ—§ä¹¦ç½‘å›¾ç‰‡ä¸‹è½½ï¼ˆè‡ªåŠ¨å»æ°´å°ï¼‰</p>\n                  <p style="font-size: 14px; color: #666;">è®©æ‚¨çš„æ—¶é—´æ›´é«˜æ•ˆ</p>\n              </div>\n              <div class="donation-body">\n                  <p>ğŸ™æ„Ÿè°¢æ‚¨é€‰æ‹©æ­¤å·¥å…·ï¼æèµ æ˜¯å¯¹æˆ‘æœ€å¤§çš„æ”¯æŒï¼Œä¹Ÿèƒ½å¸®åŠ©å·¥å…·ä¸æ–­æ”¹è¿›ä¸ç»´æŠ¤ã€‚</p>\n                  <div class="donation-images">\n                      <img src="https://greasyfork.s3.us-east-2.amazonaws.com/hve4r1x61p2vrsx2bjqjb1um8wfh" alt="æèµ äºŒç»´ç 1" class="donation-image-large" />\n                      <img src="https://greasyfork.s3.us-east-2.amazonaws.com/2w21qpqvqb9iikjqiovagnuyut1x" alt="æèµ äºŒç»´ç 2" class="donation-image-large" />\n                  </div>\n                  <br>\n                  <p style="text-align: center; margin-top: 10px;">\n                      <a href="#" id="feedbackWeChat" style="color: #007bff; text-decoration: none;">\n                          â“é—®é¢˜/å»ºè®®åé¦ˆå¾®ä¿¡ï¼šByte4Me\n                      </a>\n                      <br>\n                      <br>\n                      <a href="#" id="sideHustleGroup" style="color: #007bff; text-decoration: none;">\n                          ğŸ’°å‰¯ä¸šé¡¹ç›®ç¾¤/ç”Ÿè´¢æœ‰æœ¯ï¼ˆå¯å…¥ç¾¤æ— é™åˆ¶å…è´¹ä½“æ£€3å¤©ï¼‰\n                      </a>\n                  </p>\n              </div>\n              <div class="donation-footer">\n                  <button id="donateBtn" class="donation-button donate">æˆ‘å·²æèµ ğŸ’–</button>\n                  <button id="notDonateBtn" class="donation-button cancel">æš‚ä¸æèµ âŒ</button>\n              </div>\n          ',document.body.appendChild(t);var o=t.querySelector("#donateBtn"),r=t.querySelector("#notDonateBtn"),a=t.querySelector("#feedbackWeChat"),i=t.querySelector("#sideHustleGroup");o.addEventListener("click",function(){alert("ğŸ™æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼å¦‚æœæœ‰é—®é¢˜ï¼Œæ¬¢è¿è”ç³»å¾®ä¿¡ï¼šByte4Me"),t.remove(),n.remove(),e()}),r.addEventListener("click",function(){t.remove(),n.remove()}),a.addEventListener("click",function(n){n.preventDefault(),u("https://greasyfork.s3.us-east-2.amazonaws.com/lp9hdyffstt0wpz2ub39gw9p6srr")}),i.addEventListener("click",function(n){n.preventDefault(),u("https://greasyfork.s3.us-east-2.amazonaws.com/7cjf1r8rohkrh8xwp0mn2srocx0u")})}function u(n){var e=document.createElement("div");e.classList.add("overlay"),document.body.appendChild(e);var t=document.createElement("div");t.classList.add("image-popup"),t.innerHTML='\n              <button class="close-button">Ã—</button>\n              <img src="'+n+'" alt="Image" />\n          ',document.body.appendChild(t),t.querySelector(".close-button").addEventListener("click",function(){t.remove(),e.remove()}),e.addEventListener("click",function(){t.remove(),e.remove()})}function p(n,e){e.addEventListener("click",function(){GM_xmlhttpRequest({method:"GET",url:n,onload:function(n){d((new DOMParser).parseFromString(n.responseText,"text/html"),e)},onerror:function(n){console.log("Error:",n),e.innerText="â›” è§£æç½‘é¡µæ—¶å‡ºé”™"}})})}function f(n){p(n.querySelector(".item-info-box > .item-name > a.item-link").href,o(document,n))}function g(n){p(n.querySelector(".item-info > .title > a.link").href,r(document,n))}function m(n){p(n.querySelector("div.list-con-title > a").href,a(document,n))}function h(){document.querySelector(".product-item-box")&&(clearInterval(z),document.querySelectorAll(".product-item-box > .product-item-wrap").forEach(function(n){f(n)}))}function x(){document.querySelector("#listBox")&&(clearInterval(z),document.querySelectorAll("#listBox > .item").forEach(function(n){g(n)}))}function b(){document.querySelector("ul.itemList")&&(clearInterval(z),document.querySelectorAll("ul.itemList > li").forEach(function(n){m(n)}))}function v(){var n=document.createElement("div");n.className="confetti-container",document.body.appendChild(n);for(var e=0;e<50;e++){var t=document.createElement("div");t.className="confetti",t.style.left=100*Math.random()+"vw",t.style.animationDelay=3*Math.random()+"s",t.style.backgroundColor="hsl("+360*Math.random()+", 100%, 50%)",n.appendChild(t)}setTimeout(function(){n.remove()},5e3)}var y=window.location.href,w="downloadCount",k="donationPopupShown",E="firstExecutionv40",B=parseInt(localStorage.getItem(w))||0,C="true"===localStorage.getItem(k),S="true"===localStorage.getItem(E),z=void 0;if(S||(function(){v();var n=document.createElement("div");n.classList.add("overlay"),document.body.appendChild(n);var e=document.createElement("div");e.classList.add("update-log-popup"),e.innerHTML='\n              <div class="update-log-header">\n                  <p><a target="_blank" href="https://greasyfork.org/zh-CN/scripts/467062-%E5%AD%94%E5%A4%AB%E5%AD%90%E6%97%A7%E4%B9%A6%E7%BD%91%E5%9B%BE%E7%89%87%E4%B8%8B%E8%BD%BD-%E8%87%AA%E5%8A%A8%E5%8E%BB%E6%B0%B4%E5%8D%B0-%E8%B7%AF%E4%BA%BA%E7%94%B2%E4%B9%99%E4%B8%99">å­”å¤«å­æ—§ä¹¦ç½‘å›¾ç‰‡ä¸‹è½½ï¼ˆè‡ªåŠ¨å»æ°´å°ï¼‰æ›´æ–°æ—¥å¿—</a></p>\n                  <div style="font-size: 12px; color: #666; text-align: center;">æ¯æ¬¡å‡çº§åæ­¤çª—å£å¯èƒ½ä¼šå±•ç¤ºå¤šæ¬¡</div>\n              </div>\n              <div class="update-log-body">\n                  <ul>\n                  <li>\n                          <div style="display: flex; align-items: center; justify-content: center;">ğŸ„åœ£è¯å¿«ä¹ğŸ„</div>\n                          <p style="font-weight: bold;">[2024-12-25] v4.0</p>\n                          <ul>\n                              <li style="color: red;">1. æ–°å¢ Canvas å»æ°´å°ï¼Œå»æ°´å°æˆåŠŸç‡ 99.9999999% ä»¥ä¸Š</li>\n                              <li style="color: red;">2. ä¿®æ”¹æŒ‰é’®å’Œæ¶ˆæ¯å±•ç¤ºæ ·å¼ã€‚</li>\n                          </ul>\n                      </li>\n                      <li>\n                          <p style="font-weight: bold;">[2024-12-23] v3.6</p>\n                          <ul>\n                              <li style="color: red;">1. ç½‘ç«™å›¾ç‰‡è§„åˆ™ä¿®æ”¹ï¼Œå»æ°´å°åŸºæœ¬å¤±æ•ˆï¼Œåœ¨æ‰¾åˆ°æ–°æ–¹æ³•å‰ï¼Œå»æ°´å°å¤±è´¥ä¼šè‡ªåŠ¨é™çº§åˆ°ä¸‹è½½åŸå›¾ã€‚</li>\n                          </ul>\n                      </li>\n                      <li>\n                          <p style="font-weight: bold;">[2024-07-31] v3.5</p>\n                          <ul>\n                              <li>1. ä¿®å¤ https://item.kongfz.com/index.php? å‰ç¼€ç½‘é¡µä¸æ˜¾ç¤ºä¸‹è½½æŒ‰é’®çš„é—®é¢˜ã€‚</li>\n                          </ul>\n                      </li>\n                      <li>\n                          <p style="font-weight: bold;">[2024-06-21] v3.4</p>\n                          <ul>\n                              <li>1. ä¿®å¤åˆ—è¡¨é¡µä¸‹è½½å›¾ç‰‡éƒ¨åˆ†ä¸‹è½½å‡ºé”™çš„é—®é¢˜ã€‚</li>\n                              <li>2. åˆ†ç±»é¡µé¢å¢åŠ ä¸€é”®ä¸‹è½½åŠŸèƒ½ã€‚</li>\n                              <li>3. ä¼˜åŒ–ä¸‹è½½å¤±è´¥äº¤äº’å’Œä¸‹è½½ç»“æŸåçš„ UIã€‚</li>\n                          </ul>\n                      </li>\n                      <li>\n                          <p style="font-weight: bold;">[2024-05-23] v3.3</p>\n                          <ul>\n                              <li>1. ä¿®å¤åœ¨æŸäº›åœºæ™¯ä¸‹è¯¦æƒ…é¡µä¸‹è½½çš„éƒ¨åˆ†å›¾ç‰‡å¾ˆæ¨¡ç³Šçš„é—®é¢˜ã€‚</li>\n                          </ul>\n                      </li>\n                      <li>\n                          <p style="font-weight: bold;">[2024-05-15] v3.2</p>\n                          <ul>\n                              <li>1. ä¿®å¤æœç´¢ç»“æœé¡µæ²¡æœ‰ä¸‹è½½æŒ‰é’®çš„é—®é¢˜ã€‚</li>\n                          </ul>\n                      </li>\n                      <li>\n                          <p style="font-weight: bold;">[2024-05-15] v3.1</p>\n                          <ul>\n                              <li>1. ä¿®å¤æœç´¢ç»“æœé¡µæ²¡æœ‰ä¸‹è½½æŒ‰é’®çš„é—®é¢˜ã€‚</li>\n                          </ul>\n                      </li>\n                  </ul>\n                  <p style="text-align: center; margin-top: 10px;">\n                      <a href="#" id="donation" style="color: #007bff; text-decoration: none;">\n                          ğŸ’° å¥½æ´»ï¼Œå½“èµ\n                      </a>\n                      &nbsp;|&nbsp;\n                      <a href="#" id="scyspromotion" style="color: #007bff; text-decoration: none;">\n                          ğŸ’µ ç”Ÿè´¢æœ‰æœ¯ï¼ˆå‰¯ä¸šç¤¾ç¾¤ï¼‰å…è´¹ä½“æ£€å¡\n                      </a>\n                  </p>\n              </div>\n              <div class="update-log-footer">\n                  <button id="closeUpdateLogBtn" class="update-log-button">æˆ‘çŸ¥é“äº†</button>\n              </div>\n          ',document.body.appendChild(e),e.querySelector("#closeUpdateLogBtn").addEventListener("click",function(){e.remove(),n.remove()});var t=e.querySelector("#donation"),o=e.querySelector("#scyspromotion");t.addEventListener("click",function(n){n.preventDefault(),s()}),o.addEventListener("click",function(n){n.preventDefault(),u("https://greasyfork.s3.us-east-2.amazonaws.com/7cjf1r8rohkrh8xwp0mn2srocx0u")})}(),function(){S=!0,localStorage.setItem(E,"true")}()),y.includes("//search.kongfz.com/"))console.log("//search.kongfz.com/"),z=setInterval(h,1e3);else if(y.includes("//book.kongfz.com/C"))console.log("//book.kongfz.com/C"),z=setInterval(x,1e3);else if(y.includes("//book.kongfz.com/")){console.log("//book.kongfz.com/");var L=function(n){var e=document.createElement("button");return e.innerText="ğŸ‘‰ ä¸‹è½½å›¾ç‰‡ï¼ˆ"+n.length+"ï¼‰",e.id="downloadButton",e.style.backgroundColor="#8c222c",e.style.color="white",document.body.appendChild(e),e}(l(document));L.addEventListener("click",function(){return i(document,L)})}else y.includes("//item.kongfz.com/")&&(console.log("//item.kongfz.com/"),z=setInterval(b,1e3));GM_addStyle("\n    #downloadButton {\n    position: fixed;\n    bottom: 20px;\n    right: 20px;\n    padding: 10px 20px;\n    background-color: #333;\n    color: #fff;\n    border: none;\n    border-radius: 5px;\n    cursor: pointer;\n    z-index: 9999;\n    }\n    #bugReportLink {\n    position: fixed;\n    bottom: 5px;\n    right: 20px;\n    padding: 10px 20px;\n    background-color: #333;\n    color: #fff;\n    border: none;\n    border-radius: 5px;\n    cursor: pointer;\n    z-index: 9999;\n    }\n    .searchPageDownloadButton {\n    padding: 1px 5px;\n    background-color: #333;\n    color: #fff;\n    border: none;\n    border-radius: 3px;\n    cursor: pointer;\n    z-index: 9999;\n    font-size: 12px;\n    margin: 0px 10px;\n    }\n    .bookListPageDownloadButton {\n    padding: 1px 5px;\n    background-color: #333;\n    color: #fff;\n    border: none;\n    border-radius: 3px;\n    cursor: pointer;\n    z-index: 9999;\n    font-size: 12px;\n    margin: 8px auto 0;\n    display: block;\n    }\n    button.disabled {\n    background-color: #ccc;\n    color: #999;\n    cursor: pointer;\n    /* å…¶ä»–æ ·å¼ */\n    }\n  .overlay {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.5);\n      z-index: 1000;\n  }\n  .donation-popup {\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: white;\n      padding: 20px;\n      border-radius: 10px;\n      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);\n      text-align: center;\n      z-index: 1001;\n      max-width: 800px;\n      width: 90%;\n  }\n  .donation-header p {\n      margin: 5px 0;\n      font-size: 18px;\n      font-weight: bold;\n      color: #333;\n  }\n  .donation-body p {\n      font-size: 14px;\n      color: #555;\n      line-height: 1.5;\n  }\n  .donation-images {\n      display: flex;\n      justify-content: space-around;\n      margin: 15px 0;\n  }\n  .donation-image-large {\n      max-width: 350px;\n      max-height: 350px;\n      border: 1px solid #ddd;\n      border-radius: 5px;\n  }\n  .donation-footer {\n      margin-top: 20px;\n  }\n  .donation-button {\n      margin: 5px;\n      padding: 10px 20px;\n      font-size: 14px;\n      border: none;\n      border-radius: 5px;\n      cursor: pointer;\n  }\n  .donation-button.donate {\n      background-color: #28a745;\n      color: white;\n  }\n  .donation-button.cancel {\n      background-color: #dc3545;\n      color: white;\n  }\n  .donation-button:hover {\n      opacity: 0.9;\n  }\n  .image-popup {\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: white;\n      border-radius: 10px;\n      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);\n      padding: 10px;\n      z-index: 1002;\n  }\n  .image-popup img {\n      max-width: 100%;\n      max-height: 90vh;\n      border-radius: 5px;\n  }\n  .image-popup .close-button {\n      position: absolute;\n      top: 10px;\n      right: 10px;\n      background: #dc3545;\n      color: white;\n      border: none;\n      border-radius: 50%;\n      width: 30px;\n      height: 30px;\n      font-size: 16px;\n      text-align: center;\n      cursor: pointer;\n  }\n  .update-log-popup {\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: white;\n      padding: 20px;\n      border-radius: 10px;\n      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);\n      text-align: left;\n      z-index: 1001;\n      max-height: 80vh;\n      overflow-y: auto;\n      max-width: 800px;\n      width: 90%;\n  }\n  .update-log-header p {\n      margin: 5px 0;\n      font-size: 18px;\n      font-weight: bold;\n      color: #333;\n      text-align: center;\n  }\n  .update-log-body ul {\n      list-style-type: disc;\n      padding-left: 20px;\n  }\n  .update-log-body ul ul {\n      list-style-type: circle;\n      padding-left: 20px;\n  }\n  .update-log-body li {\n      margin-bottom: 2px;\n  }\n  .update-log-footer {\n      margin-top: 20px;\n      text-align: center;\n  }\n  .update-log-button {\n      padding: 5px 10px;\n      font-size: 14px;\n      border: none;\n      border-radius: 5px;\n      cursor: pointer;\n      background-color: #007bff;\n      color: white;\n  }\n  .update-log-button:hover {\n      opacity: 0.9;\n  }\n\n    "),GM_addStyle("\n    .fireworks-container {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      pointer-events: none;\n      z-index: 9999;\n    }\n\n    .firework {\n      position: absolute;\n      transform: scale(1);\n      animation: scale 0.3s ease-out forwards;\n    }\n\n    .particle {\n      position: absolute;\n      width: 6px;  // å¢å¤§ç²’å­å°ºå¯¸\n      height: 6px;\n      border-radius: 50%;\n      animation: explode 1.5s ease-out forwards;\n      box-shadow: 0 0 10px 2px currentColor;  // æ·»åŠ å‘å…‰æ•ˆæœ\n    }\n\n    @keyframes scale {\n      from {\n        transform: scale(0);\n      }\n      50% {\n        transform: scale(1.2);\n      }\n      to {\n        transform: scale(1);\n      }\n    }\n\n    @keyframes explode {\n      0% {\n        transform: translateX(0) translateY(0);\n        opacity: 1;\n      }\n      50% {\n        opacity: 0.8;\n      }\n      100% {\n        transform: translateX(var(--x)) translateY(var(--y));\n        opacity: 0;\n      }\n    }\n  "),document.addEventListener("DOMContentLoaded",function(){for(var n=document.createElement("style"),e="",t=0;t<20;t++){var o=18*t+(20*Math.random()-10),r=100+50*Math.random();e+=".firework .particle:nth-child("+(t+1)+") { --x: "+Math.cos(o*Math.PI/180)*r+"px; --y: "+Math.sin(o*Math.PI/180)*r+"px; }\n"}n.textContent=e,document.head.appendChild(n)}),GM_addStyle("\n    .confetti-container {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      pointer-events: none;\n      z-index: 9999;\n      overflow: hidden;\n    }\n\n    .confetti {\n      position: absolute;\n      width: 10px;\n      height: 20px;\n      top: -20px;\n      transform-origin: center;\n      animation: confetti-fall 3s ease-in-out forwards;\n    }\n\n    @keyframes confetti-fall {\n      0% {\n        transform: translateY(0) rotate(0) scale(1);\n        opacity: 1;\n      }\n\n      25% {\n        transform: translateY(25vh) rotate(90deg) scale(0.9);\n        opacity: 0.8;\n      }\n\n      50% {\n        transform: translateY(50vh) rotate(180deg) scale(0.8);\n        opacity: 0.6;\n      }\n\n      75% {\n        transform: translateY(75vh) rotate(270deg) scale(0.7);\n        opacity: 0.4;\n      }\n\n      100% {\n        transform: translateY(100vh) rotate(360deg) scale(0.6);\n        opacity: 0;\n      }\n    }\n  ")}();